<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#a63d56">

<title>HomeEasy | Gesti√≥n</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
:root{
    --homeeasy-wine:#a63d56;
    --homeeasy-gold:#d4af37;
    --brand-color:#8d374f;
    --brand-dark:#6b293b;
    --glass-bg:rgba(255,255,255,0.12);
    --glass-border:rgba(255,255,255,0.18);
}

/* ===== BASE ===== */
html,body{
    margin:0; padding:0; height:100%;
    font-family:'Montserrat',sans-serif;
    -webkit-font-smoothing:antialiased;
    background:#f8f9fa;
    overflow: hidden; /* Evita scroll durante la carga */
}

body{
    display:flex;
    justify-content:center;
    align-items:center;
    padding-top:env(safe-area-inset-top);
    padding-bottom:env(safe-area-inset-bottom);
}

/* ================= INTRO (NUEVA EST√âTICA) ================= */
#intro-screen{
    position:fixed;
    inset:0;
    display:flex; /* Flex por defecto, JS lo ocultar√° si es necesario */
    justify-content:center;
    align-items:center;
    background:radial-gradient(circle at center,var(--brand-color) 0%,var(--brand-dark) 100%);
    color:white;
    z-index:99999;
    transition: opacity 0.8s ease, visibility 0.8s ease;
}

.intro-hidden{
    opacity:0;
    visibility:hidden;
    pointer-events: none;
}

.main-container{
    width:100%; max-width:420px; text-align:center; padding:20px;
}

.logo-triangulo{ width:75px; margin-bottom:10px; }
.version-tag{ font-size:.8rem; letter-spacing:2px; opacity:.7; margin-bottom:30px; }
.hommy-static{ width:260px; margin-bottom:40px; }

/* Loader estilo Glass */
.glass-loader{
    background:var(--glass-bg);
    backdrop-filter:blur(15px);
    border:1px solid var(--glass-border);
    border-radius:28px;
    padding:25px;
    width:100%;
    box-shadow:0 25px 50px rgba(0,0,0,.25);
}

.status-pill{
    display:flex; align-items:center; justifyContent:center;
    background:rgba(0,0,0,.2);
    padding:10px 18px; border-radius:40px; margin-bottom:15px;
}

.dot-spinner{
    width:10px; height:10px; background:var(--homeeasy-gold);
    border-radius:50%; margin-right:10px;
    animation:pulse 1.5s infinite;
}

@keyframes pulse{ 0%,100%{opacity:1} 50%{opacity:.4} }

.bar-container{
    width:100%; height:4px;
    background:rgba(255,255,255,.1);
    border-radius:10px; overflow:hidden;
}

.bar-fill{
    height:100%; width:0%;
    background:var(--homeeasy-gold);
    transition:width 0.6s ease;
}

/* ================= MENU (ESTILO ESTABLE) ================= */
.menu-container{
    width:100%; max-width:420px; text-align:center; padding:20px;
    transition: filter 0.5s ease;
}

.header-container{ margin-bottom:40px; }
.logo-img{ width:180px; display:block; margin:0 auto; filter: drop-shadow(0 4px 10px rgba(0,0,0,0.05)); }

.status-online{
    display:inline-flex; align-items:center; justify-content:center;
    margin-top:15px; padding:8px 18px; border-radius:50px;
    background:white; font-size:.65rem; font-weight:800;
    letter-spacing:1.5px; color:#555;
    box-shadow:0 5px 15px rgba(0,0,0,.08);
}

.pulse-green{
    width:8px; height:8px; background:#2ecc71;
    border-radius:50%; margin-right:10px; position:relative;
}

.pulse-green::after{
    content:""; position:absolute; width:100%; height:100%;
    background:#2ecc71; border-radius:50%;
    animation:premium-pulse 2s infinite;
}

@keyframes premium-pulse{ 0%{transform:scale(1);opacity:.8} 100%{transform:scale(3);opacity:0} }

/* Tarjetas del Men√∫ */
.menu-card{
    background:white; border-radius:18px; padding:20px;
    margin-bottom:18px; display:flex; align-items:center;
    text-decoration:none; color:#333;
    box-shadow:0 10px 25px rgba(0,0,0,.06);
    transition:transform .25s ease, box-shadow .25s ease;
    border-left: 6px solid transparent; /* Reserva espacio para borde */
}

.menu-card:active{ transform:scale(.96); }

.icon-box{
    width:55px; height:55px; border-radius:14px;
    display:flex; align-items:center; justify-content:center;
    font-size:1.3rem; margin-right:18px;
    background:var(--homeeasy-wine); color:white;
}

.menu-text{ text-align:left; }
.menu-text h3{ margin:0; font-size:1rem; font-weight:800; color:var(--homeeasy-wine); }
.menu-text p{ margin:3px 0 0; font-size:.8rem; color:#777; }

/* Estilos espec√≠ficos tarjetas Doradas/Vino */
.gold-card .icon-box{ background:var(--homeeasy-gold); }
.gold-card .menu-text h3{ color:var(--homeeasy-gold); }

footer{
    margin-top:30px; font-size:.7rem; color:#aaa;
    letter-spacing:2px; font-weight:600;
}
</style>
</head>

<body>

<div id="intro-screen">
    <div class="main-container">
        <img src="triangulogold.png" class="logo-triangulo" alt="Logo">
        <h1>HomeEasy</h1>
        <div class="version-tag">Sistema Hommy 2.0</div>
        
        <img src="hommysaludando.png" class="hommy-static" alt="Hommy">
        
        <div class="glass-loader">
            <div class="status-pill">
                <div class="dot-spinner"></div>
                <div id="status-message">Iniciando...</div>
            </div>
            <div class="bar-container">
                <div class="bar-fill" id="progress-bar"></div>
            </div>
        </div>
    </div>
</div>

<div class="menu-container">
    <div class="header-container">
        <img src="logohomeeasy.png" class="logo-img" alt="HomeEasy Logo">
        <div class="status-online">
            <div class="pulse-green"></div>
            HOMMY | ONLINE
        </div>
    </div>

    <a href="clientes.html" class="menu-card gold-card">
        <div class="icon-box"><i class="fas fa-magnifying-glass"></i></div>
        <div class="menu-text">
            <h3>Consultar Cliente</h3>
            <p>Historial y saldos pendientes</p>
        </div>
    </a>

    <a href="cotizacion.html" class="menu-card">
        <div class="icon-box"><i class="fas fa-file-invoice-dollar"></i></div>
        <div class="menu-text">
            <h3>Cotizaci√≥n</h3>
            <p>Presupuestos para clientes</p>
        </div>
    </a>

    <a href="pedido.html" class="menu-card gold-card">
        <div class="icon-box"><i class="fas fa-clipboard-list"></i></div>
        <div class="menu-text">
            <h3>Orden de Pedido</h3>
            <p>Medidas y fabricaci√≥n</p>
        </div>
    </a>

    <a href="abono.html" class="menu-card">
        <div class="icon-box"><i class="fas fa-receipt"></i></div>
        <div class="menu-text">
            <h3>Recibo de Abono</h3>
            <p>Comprobantes de pago</p>
        </div>
    </a>

    <footer>
        HomeEasy - Sistema Hommy<br>
        VERSION 2.0 ¬© 2026
    </footer>
</div>

<script>
// ==========================================
// üöÄ CONFIGURACI√ìN FINAL - HOME EASY 2.0 (MODO CINE)
// ==========================================
const URL_SCRIPT = "https://script.google.com/macros/s/AKfycbyZHaIe7hb28KKtaPBORASy_maSZ2co8dZFce44GQRiZGYg_6WoU7qn4qC-lYCQO6ZL/exec";

let appIniciada = false;

// üé¨ EL GUION DE LA PEL√çCULA (Timeline)
// Aqu√≠ controlas EXACTAMENTE qu√© pasa, cu√°ndo pasa y cu√°nto avanza la barra.
// tiempo: milisegundos desde que arranca (1000 = 1 segundo)
const guionCarga = [
    { tiempo: 100,  progreso: "15%", texto: "Hommy est√° despertando..." },
    { tiempo: 1500, progreso: "45%", texto: "Limpiando sus ojitos..." },
    { tiempo: 3000, progreso: "75%", texto: "Prepar√°ndose un caf√© virtual..." },
    { tiempo: 4500, progreso: "90%", texto: "Ajustando su gorra..." }
];

// 1. FUNCI√ìN PARA CERRAR LA INTRO
function closeIntro() {
    if (appIniciada) return;
    appIniciada = true;

    const intro = document.getElementById("intro-screen");
    const progressBar = document.getElementById("progress-bar");
    const statusMessage = document.getElementById("status-message");
    
    // Final glorioso
    if(statusMessage) statusMessage.innerText = "¬°Hommy est√° listo!";
    if(progressBar) progressBar.style.width = "100%";

    console.log("üîì Abriendo men√∫...");

    setTimeout(() => {
        if(intro) {
            intro.classList.add("intro-hidden");
            document.body.style.overflow = "auto";
            sessionStorage.setItem("APP_INIT_DONE", "true");
            setTimeout(() => { intro.style.display = "none"; }, 1000);
        }
    }, 800); // Damos un segundito para leer "Hommy est√° listo"
}

// 2. DIRECTOR DE ESCENA (Ejecuta el guion)
function correrGuion() {
    const progressBar = document.getElementById("progress-bar");
    const statusMessage = document.getElementById("status-message");

    guionCarga.forEach(escena => {
        setTimeout(() => {
            // Solo actualizamos si la app no ha terminado de cargar por velocidad extrema
            if (!appIniciada) {
                if(statusMessage) statusMessage.innerText = escena.texto;
                if(progressBar) progressBar.style.width = escena.progreso;
            }
        }, escena.tiempo);
    });
}

// 3. EL CEREBRO DEL FRONTEND
document.addEventListener("DOMContentLoaded", function() {
    
    const intro = document.getElementById("intro-screen");

    // A. ¬øYa entr√≥ antes?
    if (sessionStorage.getItem("APP_INIT_DONE") === "true") {
        if(intro) intro.style.display = "none";
        document.body.style.overflow = "auto";
        return; 
    }

    // B. ¬°ACCI√ìN! Corremos el guion visual
    correrGuion();

    // C. ‚è∞ SEGURO DE VIDA (TIMER)
    // Le damos un poco m√°s de tiempo (5.5s) para que se alcance a leer el √∫ltimo mensaje
    setTimeout(() => {
        console.log("‚è∞ Tiempo cumplido. Entrando...");
        closeIntro();
    }, 5500);

    // D. üì° DESCARGA DE DATOS
    console.log("üì° Hommy est√° buscando los archivos...");
    
    fetch(URL_SCRIPT + "?init=LOAD")
        .then(response => response.json())
        .then(data => {
            if (data.status === "ok") {
                // Procesar Clientes
                const clientesObj = {};
                if(data.clientes){
                    for (let i = 1; i < data.clientes.length; i++) {
                        const c = data.clientes[i];
                        if(c && c[0]) {
                            clientesObj[c[0]] = {
                                cedula: c[0], nombre: c[1], telefono: c[2], 
                                email: c[3], direccion: c[4]
                            };
                        }
                    }
                }

                // Procesar Ordenes
                const ordenesArr = [];
                if(data.ordenes){
                    for (let i = 1; i < data.ordenes.length; i++) {
                        const o = data.ordenes[i];
                        if(o) ordenesArr.push({ numero: o[1], cedula: o[2], nombre: o[3], total: o[6], saldo: o[10] });
                    }
                }

                localStorage.setItem("CACHE_CLIENTES", JSON.stringify(clientesObj));
                localStorage.setItem("CACHE_ORDENES", JSON.stringify(ordenesArr));
                console.log("üíæ Datos guardados.");

                // Si termin√≥ todo, esperamos un poquito para no cortar la inspiraci√≥n de Hommy bruscamente
                setTimeout(closeIntro, 1500);
            }
        })
        .catch(err => {
            console.error("‚ö†Ô∏è Error silencioso:", err);
            // El Timer del punto C se encargar√° de abrir
        });
});
</script>

