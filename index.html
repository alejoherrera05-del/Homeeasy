<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">

<meta name="apple-mobile-web-app-title" content="HomeEasy">
<link rel="apple-touch-icon" href="apple-touch-icon.png">
<link rel="icon" type="image/png" href="apple-touch-icon.png">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#8d374f">

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">

<title>HomeEasy | Gesti√≥n</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
:root{
    --homeeasy-wine:#a63d56;
    --homeeasy-gold:#d4af37;
    --brand-color:#8d374f;
    --brand-dark:#6b293b;
    --glass-bg:rgba(255,255,255,0.12);
    --glass-border:rgba(255,255,255,0.18);
}

/* =================================================
   SOLUCI√ìN REAL: ESTRUCTURA DE CAPAS
   ================================================= */

/* 1. ELIMINAR BARRAS DE DESPLAZAMIENTO NATIVAS */
html, body {
    margin: 0; 
    padding: 0; 
    width: 100%; 
    height: 100%; 
    overflow: hidden; /* ¬°ESTO MATA LA BARRA LATERAL EN PC! */
    background-color: var(--brand-color); /* Fondo de seguridad */
    font-family: 'Montserrat', sans-serif;
    -webkit-font-smoothing: antialiased;
}

/* 2. CAPA DE FONDO INM√ìVIL (Soluciona la franja blanca) */
#app-background-layer {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    z-index: -1; /* Detr√°s de todo */
    background: radial-gradient(circle at center, var(--brand-color) 0%, var(--brand-dark) 100%);
    /* Esto evita que el rebote muestre blanco, mostrar√° Vinotinto */
}

/* 3. CONTENEDOR SCROLLABLE INVISIBLE 
   El scroll ocurre AQU√ç ADENTRO, no en el body. */
#scroll-container {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    overflow-y: auto; /* Permite deslizar */
    overflow-x: hidden;
    -webkit-overflow-scrolling: touch; /* Suavidad nativa en iOS */
    
    /* ZONA SEGURA IPHONE (Para que el √∫ltimo bot√≥n no quede tapado) */
    padding-bottom: env(safe-area-inset-bottom); 
    padding-top: env(safe-area-inset-top);
    
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center; /* Centra el men√∫ verticalmente */
}

/* 4. TRUCO DE MAGIA: OCULTAR LA BARRA GRIS (SCROLLBAR) PERO PERMITIR DESLIZAR */
#scroll-container::-webkit-scrollbar {
    display: none; /* Chrome, Safari, Opera */
}
#scroll-container {
    -ms-overflow-style: none;  /* IE and Edge */
    scrollbar-width: none;  /* Firefox */
}

/* ================= INTRO (ENCIMA DE TODO) ================= */
#intro-screen {
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
    z-index: 99999;
    
    /* Flexbox para centrar */
    display: flex; 
    justify-content: center;
    align-items: center;
    
    /* Fondo propio para tapar el men√∫ mientras carga */
    background: radial-gradient(circle at center, var(--brand-color) 0%, var(--brand-dark) 100%);
    color: white;
    transition: opacity 0.8s ease, visibility 0.8s ease;
}

.intro-hidden {
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
}

.main-container {
    width: 100%; max-width: 420px; text-align: center; padding: 20px;
    position: relative;
}

.logo-triangulo{ width:75px; margin-bottom:10px; }
.version-tag{ font-size:.8rem; letter-spacing:2px; opacity:.7; margin-bottom:30px; }
.hommy-static{ width:260px; margin-bottom:40px; }

/* Loader */
.glass-loader {
    background: var(--glass-bg);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    border: 1px solid var(--glass-border);
    border-radius: 28px;
    padding: 25px;
    width: 100%;
    box-shadow: 0 25px 50px rgba(0,0,0,.25);
}

.status-pill{ display:flex; align-items:center; justify-content:center; background:rgba(0,0,0,.2); padding:10px 18px; border-radius:40px; margin-bottom:15px; }
.dot-spinner{ width:10px; height:10px; background:var(--homeeasy-gold); border-radius:50%; margin-right:10px; animation:pulse 1.5s infinite; }
@keyframes pulse{ 0%,100%{opacity:1} 50%{opacity:.4} }
.bar-container{ width:100%; height:4px; background:rgba(255,255,255,.1); border-radius:10px; overflow:hidden; }
.bar-fill{ height:100%; width:0%; background:var(--homeeasy-gold); transition:width 1s ease-in-out; }

/* ================= MENU ================= */
.menu-container {
    width: 100%; max-width: 420px; text-align: center; padding: 20px;
    transition: filter 0.5s ease;
    /* Quitamos alturas forzadas aqu√≠, el scroll-container lo maneja */
    margin: auto 0; /* Centrado vertical extra */
}

.header-container{ margin-bottom:40px; }
.logo-img{ width:180px; display:block; margin:0 auto; filter: drop-shadow(0 4px 10px rgba(0,0,0,0.05)); }

.status-online{ display:inline-flex; align-items:center; justify-content:center; margin-top:15px; padding:8px 18px; border-radius:50px; background:white; font-size:.65rem; font-weight:800; letter-spacing:1.5px; color:#555; box-shadow:0 5px 15px rgba(0,0,0,.08); }
.pulse-green{ width:8px; height:8px; background:#2ecc71; border-radius:50%; margin-right:10px; position:relative; }
.pulse-green::after{ content:""; position:absolute; width:100%; height:100%; background:#2ecc71; border-radius:50%; animation:premium-pulse 2s infinite; }
@keyframes premium-pulse{ 0%{transform:scale(1);opacity:.8} 100%{transform:scale(3);opacity:0} }

.menu-card{ background:white; border-radius:18px; padding:20px; margin-bottom:18px; display:flex; align-items:center; text-decoration:none; color:#333; box-shadow:0 10px 25px rgba(0,0,0,.06); transition:transform .25s ease, box-shadow .25s ease; border-left: 6px solid transparent; }
.menu-card:active{ transform:scale(.96); }
.icon-box{ width:55px; height:55px; border-radius:14px; display:flex; align-items:center; justify-content:center; font-size:1.3rem; margin-right:18px; background:var(--homeeasy-wine); color:white; }
.menu-text{ text-align:left; }
.menu-text h3{ margin:0; font-size:1rem; font-weight:800; color:var(--homeeasy-wine); }
.menu-text p{ margin:3px 0 0; font-size:.8rem; color:#777; }
.gold-card .icon-box{ background:var(--homeeasy-gold); }
.gold-card .menu-text h3{ color:var(--homeeasy-gold); }

footer{ margin-top:30px; font-size:.7rem; color:#aaa; letter-spacing:2px; font-weight:600; }
</style>
</head>

<body>

    <div id="app-background-layer"></div>

    <div id="intro-screen">
        <div class="main-container">
            <img src="triangulogold.png" class="logo-triangulo" alt="Logo" onerror="this.style.display='none'">
            <h1>HomeEasy</h1>
            <div class="version-tag">Sistema Hommy 2.0</div>
            
            <img src="hommysaludando.png" class="hommy-static" alt="Hommy" onerror="this.style.display='none'">
            
            <div class="glass-loader">
                <div class="status-pill">
                    <div class="dot-spinner"></div>
                    <div id="status-message">Iniciando sistema...</div>
                </div>
                <div class="bar-container">
                    <div class="bar-fill" id="progress-bar"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="scroll-container">
        <div class="menu-container">
            <div class="header-container">
                <img src="logohomeeasy.png" class="logo-img" alt="HomeEasy Logo" onerror="this.style.display='none'">
                <div class="status-online">
                    <div class="pulse-green"></div>
                    SISTEMA | ONLINE
                </div>
            </div>

            <a href="clientes.html" class="menu-card gold-card">
                <div class="icon-box"><i class="fas fa-magnifying-glass"></i></div>
                <div class="menu-text"><h3>Consultar Cliente</h3><p>Historial y saldos</p></div>
            </a>

            <a href="cotizacion.html" class="menu-card">
                <div class="icon-box"><i class="fas fa-file-invoice-dollar"></i></div>
                <div class="menu-text"><h3>Cotizaci√≥n</h3><p>Presupuestos nuevos</p></div>
            </a>

            <a href="pedido.html" class="menu-card gold-card">
                <div class="icon-box"><i class="fas fa-clipboard-list"></i></div>
                <div class="menu-text"><h3>Orden de Pedido</h3><p>Fabricaci√≥n</p></div>
            </a>

            <a href="abono.html" class="menu-card">
                <div class="icon-box"><i class="fas fa-receipt"></i></div>
                <div class="menu-text"><h3>Recibo de Abono</h3><p>Pagos y anticipos</p></div>
            </a>

            <footer>HomeEasy MANAGEMENT SYSTEM<br>VERSION 2.0 ¬© 2026</footer>
        </div>
    </div>

<script>
// ==========================================
// üöÄ L√ìGICA DE NEGOCIO (INTACTA)
// ==========================================
const URL_SCRIPT = "https://script.google.com/macros/s/AKfycbyZHaIe7hb28KKtaPBORASy_maSZ2co8dZFce44GQRiZGYg_6WoU7qn4qC-lYCQO6ZL/exec";

let appIniciada = false;

const guionCarga = [
    { tiempo: 100,  progreso: "15%", texto: "Hommy est√° despertando..." },
    { tiempo: 1500, progreso: "45%", texto: "Limpiando sus lentes..." },
    { tiempo: 3000, progreso: "75%", texto: "Prepar√°ndose un caf√© virtual..." },
    { tiempo: 4500, progreso: "90%", texto: "Ajustando su corbat√≠n..." }
];

function closeIntro() {
    if (appIniciada) return;
    appIniciada = true;

    const intro = document.getElementById("intro-screen");
    const progressBar = document.getElementById("progress-bar");
    const statusMessage = document.getElementById("status-message");
    
    if(statusMessage) statusMessage.innerText = "¬°Hommy est√° listo!";
    if(progressBar) progressBar.style.width = "100%";
    console.log("üîì Abriendo men√∫...");
    
    setTimeout(() => {
        if(intro) {
            intro.classList.add("intro-hidden");
            // No tocamos overflow del body, eso lo maneja el CSS ahora
            sessionStorage.setItem("APP_INIT_DONE", "true");
            setTimeout(() => { intro.style.display = "none"; }, 1000);
        }
    }, 800);
}

function correrGuion() {
    const progressBar = document.getElementById("progress-bar");
    const statusMessage = document.getElementById("status-message");
    guionCarga.forEach(escena => {
        setTimeout(() => {
            if (!appIniciada) {
                if(statusMessage) statusMessage.innerText = escena.texto;
                if(progressBar) progressBar.style.width = escena.progreso;
            }
        }, escena.tiempo);
    });
}

document.addEventListener("DOMContentLoaded", function() {
    const intro = document.getElementById("intro-screen");
    if (sessionStorage.getItem("APP_INIT_DONE") === "true") {
        if(intro) intro.style.display = "none";
        return; 
    }
    correrGuion();
    setTimeout(() => { closeIntro(); }, 5500);

    fetch(URL_SCRIPT + "?init=LOAD")
        .then(response => response.json())
        .then(data => {
            if (data.status === "ok") {
                const clientesObj = {};
                if(data.clientes){
                    for (let i = 1; i < data.clientes.length; i++) {
                        const c = data.clientes[i];
                        if(c && c[0]) {
                            clientesObj[c[0]] = {
                                cedula: c[0], nombre: c[1], telefono: c[2], 
                                email: c[3], direccion: c[4]
                            };
                        }
                    }
                }
                const ordenesArr = [];
                if(data.ordenes){
                    for (let i = 1; i < data.ordenes.length; i++) {
                        const o = data.ordenes[i];
                        if(o) ordenesArr.push({ numero: o[1], cedula: o[2], nombre: o[3], total: o[6], saldo: o[10] });
                    }
                }
                localStorage.setItem("CACHE_CLIENTES", JSON.stringify(clientesObj));
                localStorage.setItem("CACHE_ORDENES", JSON.stringify(ordenesArr));
                setTimeout(closeIntro, 1500);
            }
        })
        .catch(err => { console.error("‚ö†Ô∏è Error:", err); });
});
</script>

</body>
</html>
